function yout=thermo_combustor(Pt4,Ht4,F_A,Cp3)


Tt4=Ht4/Cp3;
for i=1:25
    Cp4=((Cp(Tt4)+(F_A)*CCp(Tt4))/(1+F_A));
    Ht4s=((h(Tt4)+(F_A)*hh(Tt4))/(1+F_A));
    Phi4=((s(Tt4)+(F_A)*sss(Tt4))/(1+F_A));
    deltaHcch=Ht4-Ht4s;
    errorHcch=deltaHcch/Ht4s;
    if abs(errorHcch) > 0.00001
       Tt4=Tt4+(deltaHcch/Cp4);
    end
    Mw4 = 28.97 - 0.946186 * F_A;
    Rg = 8.31416/ Mw4; 
    S4=Phi4-(Rg*log(Pt4));
end
Cp4=((Cp(Tt4)+(F_A)*CCp(Tt4))/(1+F_A));

  


yout=[Tt4 S4 Cp4 Mw4];


function outs_air=s(t)
Y = 1.8*t;
outs_air= 4.184* ((0.25020051*log(Y))+(1.4450767E-26*Y^7)-(2.4211288E-22*Y^6)+(1.5243153E-18*Y^5)-(3.782064E-15*Y^4)-(2.239279E-12*Y^3)+(3.2759743E-8*Y^2)-(5.1576879E-5*Y)+0.0454323);

function outs_fuel=sss(t)
Y = 1.8*t;
outs_fuel = 4.184* ((0.073816638 * log(Y))+(1.038267E-25 * Y^7)-(2.22261188D-21* Y^6)+(2.0425826D-17* Y^5)-(1.0512776D-13* Y^4)+( 3.3228928D-10* Y^3)-(6.8859505E-7* Y^2)+(1.225863E-03* Y)+ 0.688595);

function outh_air=h(t)
Y = 1.8*t;
outh_air=0.55555*4.184*((1.2644425E-26 * Y^8)-(2.0752522E-22*Y^7)+(1.270263E-18*Y^6)-(3.0256518E-15*Y^5)-(1.6794594E-12*Y^4)+(2.1839826E-8*Y^3)-(2.575844E-5*Y^2)+(0.2502*Y)-1.7558886);

function outh_fuel=hh(t)
Y = 1.8*t;
outh_fuel=0.55555*4.184*((9.0848388D-26*Y^8)-(1.9050949D-21*Y^7)+(1.7021525D-17*Y^6)-(8.4102208D-14*Y^5)+(2.4921698D-10*Y^4)-(4.5906332E-7*Y^3)+(6.129315E-04*Y^2)+(0.073816638*Y)+30.058153);

function outCp_air=Cp(t)
Y = 1.8*t;
outCp_air=4.184*(((1.01554E-25*Y^7)-(1.452677E-21*Y^6)+(7.6215767E-18*Y^5)-(1.5128259E-14*Y^4)-(6.717836E-12*Y^3)+(6.5519486E-8*Y^2)-(5.1536079E-5*Y))+0.25);

function outCp_fuel=CCp(t)
Y = 1.8*t;
outCp_fuel = 4.184*(((7.26787E-25 * Y^7)-(1.3335668D-20*Y^6)+(1.0212913D-16*Y^5)-(4.2051104D-13*Y^4)+(9.968792E-10*Y^3)-(1.3771901E-6*Y^2)+(1.225863E-03*Y))+0.073816638);